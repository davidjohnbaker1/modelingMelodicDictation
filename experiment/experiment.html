<!DOCTYPE html>
<html>
  <head>
    <script src="plugins/jspsych.js"></script>
    <script src="plugins/jspsych-survey-likert.js"></script>
    <script src="plugins/jspsych-audio-button-response.js"></script>
    <script src="plugins/jspsych-instructions.js"></script>
    <link rel="stylesheet" href="css/jspsych.css"></link>
  </head>
  <body></body>
  <script>

// Scales Needed

var scale = ["Strongly Disagree", "Disagree", "Neutral", "Agree", "Strongly Agree"];

var baisScaleV = ["<p>1</p>No Image Present at All<p>", "", "", "<p>4</p><p>Fairly Vivid</p>","","","<p>7</p><p>As Vivid As The Actual Sound</p>"]

var baisScaleC = ["<p>1</p>No Image Present at All</p>", "","","<p>4</p>Could Change the Image but With Effort</p>","","","<p>7</p><p>Extremely Easy to Change the Image</p>"]

// Preloading

var audiopaths = [	 	
			// Place Holders
	
			'sound/hammer.mp3',

			// Melodies

			'sound/mp3/yankee.mp3',

			'sound/mp3/setupYankee.mp3',
			'sound/mp3/setupYankee.mp3',
		        'sound/mp3/setupDoremi.mp3',
			'sound/mp3/setupHappy.mp3', 
                        'sound/mp3/setupMary.mp3',
			'sound/mp3/setupDeck.mp3',  
			'sound/mp3/setupJingle.mp3',

			// Silences	

			'sound/mp3/fiveSecondSilence.wav',
			'sound/mp3/tenSecondSilence.wav',
			'sound/mp3/twentySecondSilence.wav',

			// Triangles

			'sound/mp3/DoubleTriangle.mp3',
			'sound/mp3/Triangle.mp3'

		];

// Timeline Loop

var timeline = [];

/// Subject ID


var subject_id = prompt("Enter Participant Number");
        jsPsych.data.addProperties({
                          subject: subject_id,
                });


//////////////////////////////////////////////////
// Welcome, Consent Form, Materials Check 
/////////////////////////////////////////////////

var welcome= {
    type: 'instructions',
    pages: ['<p align="justify">Welcome to this experiment on melodic dictation!</p><p>Please click the button below to begin!</p>',
      '<p align="justify">This study is examining factors that might contribute to an individual&#39;s ability to dictate musical material. This experiment will take place in two parts. The first part requires listening to various melodies played through a speaker in a classroom setting and attempting dictate what is heard.  After completing the first part of the experiment, you will be asked to come back into the lab to fill out a selection of surveys thought to contribute to processes involved in musical dictation such as your musical sophistication, your memory, and your ability to imagine musical tones. Subjects may choose not to participate or to withdraw from the study at any time without penalty or loss of any benefit to which they might otherwise be entitled. All data will be made anonymous, and all efforts will be made to keep possible identifying data private and secure. This study has been approved by the LSU IRB. For questions concerning participant rights, please contact the IRB Chair, Dr. Dennis Landin, 578-8692, or irb@lsu.edu. The Primary Investigator is Dr. Daniel Shanahan, who can be contacted at dshanahan@lsu.edu with any questions or concerns you might have. The co-investigator is David Baker (dbake29@lsu.edu). </p><p>If you are willing to partake in this experiment, please sign the form in front of you, pass it to the experimenter, then click the next button below</p>',
      '<p align="justify">This experiment is meant to reproduce what a melodic dictation in an Aural Skills classroom would be like in a controlled setting. Please note that at this point you should have both staff paper as well as a pencil on your desk which you will use for the experiment. If you do not have either or both staff paper and a pencil, please let the experimenter know now. Put phones away at this time. </p>','<p align="justify">Please put the headphones on next to you. On the next screen you will hear a melody. Please adjust the volume to a comfortable volume as the melody plays. If the volume level is satisfactory, just enjoy the melody!</p>'],
    show_clickable_nav: true
  };

timeline.push(welcome)

// Audio At Comfortable Level

var audiocomfort={
    type: 'audio-button-response',
    stimulus: 'sound/mp3/yankee.mp3',
    choices: ['NEXT'],
    prompt: "<p>Please adjust the volume HERE to a comfortable level.</p>"
  };

timeline.push(audiocomfort)

// Instructions for Experiment

// ADD IN BIT HERE ABOUT TIME TO FLIP TO CORRECT PAGE

var maininstructions ={
    type: 'instructions',
    pages: ['<p align="justify">For this experiment you will perform FIVE melodic dictations on relatively short melodies.</p><p align="justify">Each melody will be played FIVE times. Prior to hearing each melody, the key will be established via a I &mdash; IV &mdash; I &mdash; V7 &mdash; I progression. Once the key is established, you will hear a two bars for nothing played by a clave. For example, if the melody is in 4/4 time,  you will hear eight clave clicks representing four quarter notes and then  the melody will begin to play. The times signature, mode, and key signature of each melody is provided on your paper. After each melody is played you will have 30 seconds before the next hearing. A triangle sound will play before every hearing. Before the final hearing of the melody the triangle will be played twice. After the last hearing of the melody, you will have two minutes to make any needed corrections to your paper.</p>','<p align="justify">PUT SOMETHING IN ABOUT HERE ABOUT FLIPPING TO THE RIGHT MELODY.</p><p align="justify"> A THIS SOUND WILL PLAY WHEN THE NEW MELODY IS ABOUT TO START. It is very important that once you have moved on to the next melody that you do not correct any previous melodies. Changes outside of the allotted time will corrupt any data we are trying to collect. If you understand this, press next.</p>',
      '<p align="justify">The your dication will be graded in two parts. Half of the grade will come from having the correct rhythms in the correct places. For example, if the first bar is all eight-notes, and you write that, you would get half points for that bar. The other half of the possible points for the bar will come from identifying the correct scale degrees with the rhythm. Note that you will NOT be given the starting pitch and should infer it from the cadence.</p><p align="justify">After the last dictation you will be asked to use the blank piece of non-staff paper given to you to write down strategies you used during the experiment.</p>','<p align="justify">To review, you will hear each melody FIVE times. Please do your best to dictate it as you would in an aural skills classroom setting noting with each hearing how confident you were with your answer at that point.</p><p align="justify">If there are any questions at this point, please ask the experimenter. If not, the experiment will begin. Please ask any questions the experimenter now. When you are ready to begin the experiment, please press NEXT!</p>' ],
    show_clickable_nav: true
  };

timeline.push(maininstructions)

</script>
<script src="mainloop.js"></script>

<script>
// Add in thing here about break and now going to fill out demographics

// Deomographics 
/// Aural Skills
///// Make sure to have recency item
///// AP question
/// Goldsmiths 


/// Aural Skills Questions

var aural={
    type: 'instructions',
    pages: ['Welcome to the experiment on melodic dictation. On this screen I will tell the participans that I really appreciate what they are doing here and that they need to Click next to begin.',
      'On this page I am going to put the consent form. They will read it on here and note that the click will indicate some sort of conset and that they should also sign the hard copy that is in front of them (experimenter needs to then put that into the binder.',
      'With that out of the way, next thing is to make sure that you have a pencil, staff paper, and that your headphones are set to a confortable volume'],
    show_clickable_nav: true
  };

timeline.push(aural)

/// Gold MSI

var goldmsi={
      type: 'survey-likert',
      questions: [{prompt: "I like vegetables.", labels: scale, required: true}, {prompt: "I like fruit.", labels: scale, required: true}],
  };

timeline.push(goldmsi)

/// Bucknell Auditory Imagery Scale

var introBucknell= {
    type: 'instructions',
    pages: ['<p align="justify">Bucknell Auditory Imagery Scale</p><p>Please click NEXT to continue!</p>'],
    show_clickable_nav: true
  };


timeline.push(introBucknell)


var bucknellV={
      type: 'survey-likert',
      preamble: 'The following scale is designed to measure auditory imagery, or the way in which you "think about sounds in your head." For the following items you are asked to do the following: Read the item and consider whether you think of an image of the described sound in your head. Then rate the vividness of your image using the following "Vividness Rating Scale." If no image is generated, give a rating of 1. Please feel free to use all of the levels in the scale when selecting your ratings.',
      questions: [	{prompt:'<p>For the first item, consider the beginning of the song "Happy Birthday."</p><p>The sound of a trumpet beginning the piece.</p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider ordering something over the phone.</p><p>The voice of an elderly clerk assisting you.</p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider being at the beach.</p><p>The sound of the waves crashing against nearby rocks.</p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider going to a dentist appointment.</p><p>The loud sound of the dentist\'s drill.</p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider being present at a jazz club.</p><p>The sound of a saxophone solo.</p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider being at a live baseball game.</p><p>The cheer of the crowd as a player hits the ball.</p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider attending a choir rehearsal.</p><p>The sound of an all-children\'s choir singing the first verse of a song.</p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider attending an orchestral performance of Beethoven\'s Fifth.</p><p>The sound of the ensemble playing. </p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider listening to a rain storm.</p><p>The sound of gentle rain. </p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider attending classes.</p><p>The slow-paced voice of your English teacher.</p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider seeing a live opera performance.</p><p>The voice of an opera singer in the middle of a verse.</p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider attending a new tap-dance performance.</p><p>The sound of tap-shoes on the stage.</p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider a kindergarten class.</p><p>The voice of the teacher reading a story to the children.</p>', labels: baisScaleV, required: true},
			{prompt:'<p>For the next item, consider driving in a car.</p><p>The sound of an upbeat rock song on the radio.</p>', labels: baisScaleV, required: true}

		],
  };

timeline.push(bucknellV)

var bucknellC={
      type: 'survey-likert',
      preamble: 'The following scale is designed to measure auditory imagery, or the way in which you "think about sounds in your head." For the following pairs of items you are asked to do the following: Read the first item (marked "a") and consider whether you think of an image of the described sound in your head. Then read the second item (marked "b") and consider how easily you could change your image of the first sound to that of the second sound and hold this image. Rate how easily you could make this change using the "Ease of Change Rating Scale." If no images are generated, give a rating of 1. Please read "a" first and "b" second for each pair. It may be necessary to cover up "b" so that you focus first on "a" for each pair. Please feel free to use all of the levels in the scale when selecting your ratings.',
      questions: [	
{prompt:'<p> For the first pair,  consider attending a choir rehearsal.</p><p>a. The sound of an all-children\'s choir singing the first verse of a song.</p><p>b. An all-adults\' choir now sings the second verse of the song.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider being present at a jazz club.</p><p>a. The sound of a saxophone solo.</p><p>b. The saxophone is now accompanied by a piano.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider listening to a rain storm.</p><p>a. The sound of gentle rain.</p><p>b. The gentle rain turns into a violent thunderstorm.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider driving in a car.</p><p>a. The sound of an upbeat rock song on the radio.</p><p>b. The song is now masked by the sound of the car coming to a screeching halt.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider ordering something over the phone.</p><p>a. The voice of an elderly clerk assisting you.</p><p>b. The elderly clerk leaves and the voice of a younger clerk is now on the line.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider seeing a live opera performance.</p><p>a. The voice of an opera singer in the middle of a verse.</p><p>b. The opera singer now reaches the end of the piece and holds the final note.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider going to a dentist appointment.</p><p>a. The loud sound of the dentist\'s drill.</p><p>b. The drill stops and you can now hear the soothing voice of the receptionist.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider the beginning of the song "Happy Birthday."</p><p>a. The sound of a trumpet beginning the piece.</p><p>b. The trumpet stops and a violin continues the piece.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider attending an orchestral performance of Beethoven\'s Fifth.</p><p>a. The sound of the ensemble playing.</p><p>b. The ensemble stops but the sound of a piano solo is present.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider attending a new tap\-dance performance.</p><p>a. The sound of tap\-shoes on the stage.</p><p>b. The sound of the shoes speeds up and gets louder.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider being at a live baseball game.</p><p>a. The cheer of the crowd as a player hits the ball.</p><p>b. Now the crowd boos as the fielder catches the ball.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider a kindergarten class.</p><p>a. The voice of the teacher reading a story to the children.</p><p>b. The teacher stops reading for a minute to talk to another teacher.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider attending classes.</p><p>a. The slow\-paced voice of your English teacher.</p><p>b. The pace of the teacher\'s voice gets faster at the end of class.</p>', labels: baisScaleC, required: true},
{prompt:'<p> For the next pair, consider being at the beach.</p><p>a. The sound of the waves crashing against nearby rocks.</p><p>b. The waves are now drowned out by the loud sound of a boat\'s horn out at sea.</p>', labels: baisScaleC, required: true}
		],
  };

timeline.push(bucknellC)


// SAVE FUNCTION

function saveData(name, data){
  var xhr = new XMLHttpRequest();
  xhr.open('POST', 'write_data.php'); // 'write_data.php' is the path to the php file described above.
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.send(JSON.stringify({filename: name, filedata: data}));
}

// Thanks for all your help!!  

  jsPsych.init({
    timeline: timeline,
    preload_audio: audiopaths,
    on_finish: function(){ jsPsych.data.get().localSave('csv', subject_id + '.csv');}  

});

  </script>
</html>
